name: AI News Bot Daily Sync
on:
  schedule:
    # é€™è£¡çš„ Cron å°æ‡‰å°ç£æ™‚é–“ 09, 12, 18, 21 é» [cite: 737]
    - cron: '0 1,4,10,13 * * *'
  [cite_start]workflow_dispatch: # å…è¨±æ‰‹å‹•æ¸¬è©¦åŸ·è¡Œ [cite: 738]
jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write # çµ¦äºˆå¯«å…¥æ¬Šé™ä»¥ä¾¿æ›´æ–° PWA
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      - name: Install dependencies
        # å®‰è£ Google GenAI èˆ‡ Requests å¥—ä»¶ [cite: 750]
        run: pip install requests google-genai
      - name: Run Bot
        [cite_start]env: # å°‡ Secrets æ³¨å…¥ç’°å¢ƒè®Šæ•¸ [cite: 752-755]
          LINE_CHANNEL_ACCESS_TOKEN: ${{ secrets.LINE_CHANNEL_ACCESS_TOKEN }}
          LINE_USER_ID: ${{ secrets.LINE_USER_ID }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        run: python main.py
      - name: Commit and Push PWA Data
        run: |
          git config --global user.name "GitHub Action"
          git config --global user.email "action@github.com"
          # æª¢æŸ¥æ˜¯å¦æœ‰è®Šå‹•ï¼Œæœ‰çš„è©±æ‰ä¸Šå‚³ [cite: 761-762]
          if [[ -n $(git status -s latest_news.json) ]]; then
            git add latest_news.json
            git commit -m "ğŸ¤– Auto-update News: $(date)"
            git push
          fi
